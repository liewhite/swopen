package io.github.liewhite.web3.contract

import org.scalatest.funsuite.AnyFunSuite
import scala.compiletime.constValue


import io.github.liewhite.web3.contract.types.ABIStaticArray
import io.github.liewhite.web3.contract.types.ABIIntN
import io.github.liewhite.web3.contract.types.ABIString
import io.github.liewhite.web3.contract.types.ABIAddress
import io.github.liewhite.web3.types.BytesType
import io.github.liewhite.web3.types.Address
import io.github.liewhite.web3.contract.types.*
import io.github.liewhite.web3.common.*
import io.github.liewhite.web3.Extensions.*


class RealUsedTest extends AnyFunSuite {
  test("univ3 multicall: ropsten 0xaa3e533c56497208ada9dc0bd9dd994fb42f4e06f2e151427f2b8e470100dde0") {
    assert {
      val data = "0x5ae401dc00000000000000000000000000000000000000000000000000000000624b1b16000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000000e442712a670000000000000000000000000000000000000000000000003bacab3782ec022f000000000000000000000000000000000000000000000000000059958d22eb1000000000000000000000000000000000000000000000000000000000000000800000000000000000000000006ac39785f4145b595313840dc6e1d2a753d87e1f0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000c778417e063141139fce010982780140aa0cd5ab00000000000000000000000092e882414a75d386e4e234136ed9ce6e476f323100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000412210e8a00000000000000000000000000000000000000000000000000000000"
      val f = ABIFunction[(ABIUintN[256], ABIDynamicArray[ABIDynamicBytes]), Unit]("multicall")
      val result = f.unpackInput(data.toBytes.!)
      result.isRight && result.!._1.value == 0x624b1b16
    }
  }
}